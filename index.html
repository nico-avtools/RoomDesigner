<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1894.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 14.2px 0.0px; font: 12.0px Times}
    p.p2 {margin: 0.0px 0.0px 14.2px 0.0px; font: 12.0px Times; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="UTF-8" /&gt;</p>
<p class="p1">&lt;title&gt;Line Array Designer - V3&lt;/title&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1">/* Basic styling for the page and controls */</p>
<p class="p1">body {</p>
<p class="p1">font-family: Arial, sans-serif;</p>
<p class="p1">margin: 20px;</p>
<p class="p1">}</p>
<p class="p1">.controls {</p>
<p class="p1">margin-bottom: 10px;</p>
<p class="p1">}</p>
<p class="p1">.splay-control {</p>
<p class="p1">display: inline-block;</p>
<p class="p1">margin-right: 10px;</p>
<p class="p1">}</p>
<p class="p1">svg {</p>
<p class="p1">border: 1px solid #ccc;</p>
<p class="p1">background-color: #f8f8f8;</p>
<p class="p1">}</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1">&lt;h1&gt;Line Array Designer - V3&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- Checkbox to toggle the addition of a LineArray --&gt;</p>
<p class="p1">&lt;div class="controls"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">&lt;input type="checkbox" id="addLineArray" /&gt;</p>
<p class="p1">Add LineArray</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- Input for Trim Height: vertical positioning of the line array --&gt;</p>
<p class="p1">&lt;div class="controls"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">Trim Height (ft):</p>
<p class="p1">&lt;input type="number" id="trimHeight" value="5" step="0.5" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- Input for Speaker Position: horizontal placement of the line array --&gt;</p>
<p class="p1">&lt;div class="controls"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">Speaker Position (ft):</p>
<p class="p1">&lt;input type="number" id="speakerPosition" value="2" step="0.5" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- Input for LineArray Size: number of speakers in the array --&gt;</p>
<p class="p1">&lt;div class="controls"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">LineArray Size:</p>
<p class="p1">&lt;input type="number" id="lineArraySize" value="1" min="1" max="6" step="1" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- Splay Angle Inputs A through E. They will be shown/hidden based on array size. --&gt;</p>
<p class="p1">&lt;div class="controls" id="splayAnglesContainer"&gt;</p>
<p class="p1">&lt;div class="splay-control" id="splayControlA"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">Splay A (°):</p>
<p class="p1">&lt;input type="number" id="splayA" value="0" min="0" max="10" step="0.5" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p1">&lt;div class="splay-control" id="splayControlB"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">Splay B (°):</p>
<p class="p1">&lt;input type="number" id="splayB" value="0" min="0" max="10" step="0.5" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p1">&lt;div class="splay-control" id="splayControlC"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">Splay C (°):</p>
<p class="p1">&lt;input type="number" id="splayC" value="0" min="0" max="10" step="0.5" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p1">&lt;div class="splay-control" id="splayControlD"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">Splay D (°):</p>
<p class="p1">&lt;input type="number" id="splayD" value="0" min="0" max="10" step="0.5" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p1">&lt;div class="splay-control" id="splayControlE"&gt;</p>
<p class="p1">&lt;label&gt;</p>
<p class="p1">Splay E (°):</p>
<p class="p1">&lt;input type="number" id="splayE" value="0" min="0" max="10" step="0.5" /&gt;</p>
<p class="p1">&lt;/label&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- SVG area where the line array will be visualized --&gt;</p>
<p class="p1">&lt;svg id="diagram" width="600" height="800"&gt;</p>
<p class="p1">&lt;!-- Group element to hold all speaker polygons in the line array --&gt;</p>
<p class="p1">&lt;g id="lineArrayGroup"&gt;&lt;/g&gt;</p>
<p class="p1">&lt;/svg&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">/**********************************************************************</p>
<p class="p1">* Line Array Designer V3 JavaScript</p>
<p class="p1">*<span class="Apple-converted-space"> </span></p>
<p class="p1">* This script extends the previous version by adding splay angles between</p>
<p class="p1">* speaker boxes. Each splay angle tilts the boxes below it horizontally.</p>
<p class="p1">**********************************************************************/</p>
<p class="p2"><br></p>
<p class="p1">// Constants for scaling and speaker dimensions in feet.</p>
<p class="p1">const scaleFeet = 10; // Scale: 1 foot equals 10 pixels.</p>
<p class="p1">const SPEAKER_WIDTH = 2; // Each speaker is 2 feet wide.</p>
<p class="p1">const LEFT_HEIGHT = 0.6; // Left side height of speaker in feet.</p>
<p class="p1">const RIGHT_HEIGHT = 1.0; // Right side height of speaker in feet.</p>
<p class="p2"><br></p>
<p class="p1">// Get references to HTML elements.</p>
<p class="p1">const addLineArrayCheckbox = document.getElementById('addLineArray');</p>
<p class="p1">const trimHeightInput = document.getElementById('trimHeight');</p>
<p class="p1">const speakerPositionInput = document.getElementById('speakerPosition');</p>
<p class="p1">const lineArraySizeInput = document.getElementById('lineArraySize');</p>
<p class="p1">const svg = document.getElementById('diagram');</p>
<p class="p1">const lineArrayGroup = document.getElementById('lineArrayGroup');</p>
<p class="p1">const splayAnglesContainer = document.getElementById('splayAnglesContainer');</p>
<p class="p2"><br></p>
<p class="p1">// Array of splay input elements for easy access.</p>
<p class="p1">const splayInputs = [</p>
<p class="p1">document.getElementById('splayA'),</p>
<p class="p1">document.getElementById('splayB'),</p>
<p class="p1">document.getElementById('splayC'),</p>
<p class="p1">document.getElementById('splayD'),</p>
<p class="p1">document.getElementById('splayE')</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">// Array of splay control containers to show/hide based on size.</p>
<p class="p1">const splayControls = [</p>
<p class="p1">document.getElementById('splayControlA'),</p>
<p class="p1">document.getElementById('splayControlB'),</p>
<p class="p1">document.getElementById('splayControlC'),</p>
<p class="p1">document.getElementById('splayControlD'),</p>
<p class="p1">document.getElementById('splayControlE')</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">/**</p>
<p class="p1">* updateSplayControls()</p>
<p class="p1">*<span class="Apple-converted-space"> </span></p>
<p class="p1">* Shows or hides splay angle inputs based on the current line array size.</p>
<p class="p1">*/</p>
<p class="p1">function updateSplayControls(arraySize) {</p>
<p class="p1">// Number of splay angles needed = arraySize - 1.</p>
<p class="p1">const needed = Math.max(0, arraySize - 1);</p>
<p class="p1">for (let i = 0; i &lt; splayControls.length; i++) {</p>
<p class="p1">// Show control if within needed range, otherwise hide.</p>
<p class="p1">splayControls[i].style.display = i &lt; needed ? 'inline-block' : 'none';</p>
<p class="p1">}</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/**</p>
<p class="p1">* updateDiagram()</p>
<p class="p1">*<span class="Apple-converted-space"> </span></p>
<p class="p1">* Updates the SVG to display the line array of trapezoidal speaker shapes,</p>
<p class="p1">* taking into account splay angles between boxes.</p>
<p class="p1">*/</p>
<p class="p1">function updateDiagram() {</p>
<p class="p1">// Clear existing speaker shapes.</p>
<p class="p1">while (lineArrayGroup.firstChild) {</p>
<p class="p1">lineArrayGroup.removeChild(lineArrayGroup.firstChild);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// Only proceed if "Add LineArray" is checked.</p>
<p class="p1">if (!addLineArrayCheckbox.checked) return;</p>
<p class="p2"><br></p>
<p class="p1">// Parse user input values.</p>
<p class="p1">let trimHeightFt = parseFloat(trimHeightInput.value) || 0;</p>
<p class="p1">let speakerPosFt = parseFloat(speakerPositionInput.value) || 0;</p>
<p class="p1">let arraySize = parseInt(lineArraySizeInput.value) || 1;</p>
<p class="p2"><br></p>
<p class="p1">// Clamp array size between 1 and 6.</p>
<p class="p1">arraySize = Math.max(1, Math.min(arraySize, 6));</p>
<p class="p2"><br></p>
<p class="p1">// Update which splay angle controls are visible based on array size.</p>
<p class="p1">updateSplayControls(arraySize);</p>
<p class="p2"><br></p>
<p class="p1">// Read splay angle values for each connection up to arraySize-1.</p>
<p class="p1">let splayAngles = [];</p>
<p class="p1">for (let i = 0; i &lt; arraySize - 1; i++) {</p>
<p class="p1">let angle = parseFloat(splayInputs[i].value) || 0;</p>
<p class="p1">// Convert angle to radians for calculation.</p>
<p class="p1">splayAngles.push(angle * Math.PI / 180);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// Calculate speaker dimensions in pixels.</p>
<p class="p1">const widthPx = SPEAKER_WIDTH * scaleFeet; // 2 ft wide in pixels.</p>
<p class="p1">const leftHeightPx = LEFT_HEIGHT * scaleFeet; // 0.6 ft tall on left side in pixels.</p>
<p class="p1">const rightHeightPx = RIGHT_HEIGHT * scaleFeet; // 1.0 ft tall on right side in pixels.</p>
<p class="p2"><br></p>
<p class="p1">// Determine starting horizontal position.</p>
<p class="p1">const speakerPosPx = speakerPosFt * scaleFeet;</p>
<p class="p1">let currentX = speakerPosPx;</p>
<p class="p2"><br></p>
<p class="p1">// Determine starting vertical position (for the top speaker).</p>
<p class="p1">let svgHeight = parseFloat(svg.getAttribute('height'));</p>
<p class="p1">let initialY = svgHeight - (trimHeightFt * scaleFeet) - rightHeightPx;</p>
<p class="p1">let currentY = initialY;</p>
<p class="p2"><br></p>
<p class="p1">// Loop through each speaker in the array.</p>
<p class="p1">for (let i = 0; i &lt; arraySize; i++) {</p>
<p class="p1">// Create a new SVG polygon for the speaker.</p>
<p class="p1">let polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');</p>
<p class="p2"><br></p>
<p class="p1">// Define trapezoidal points for the current speaker.</p>
<p class="p1">let points = [</p>
<p class="p1">`${currentX},${currentY}`, // Top-left</p>
<p class="p1">`${currentX + widthPx},${currentY}`, // Top-right</p>
<p class="p1">`${currentX + widthPx},${currentY + rightHeightPx}`, // Bottom-right</p>
<p class="p1">`${currentX},${currentY + leftHeightPx}` // Bottom-left</p>
<p class="p1">].join(" ");</p>
<p class="p2"><br></p>
<p class="p1">polygon.setAttribute('points', points);</p>
<p class="p1">polygon.setAttribute('fill', '#999');</p>
<p class="p1">polygon.setAttribute('stroke', '#000');</p>
<p class="p2"><br></p>
<p class="p1">// Add the speaker shape to the SVG group.</p>
<p class="p1">lineArrayGroup.appendChild(polygon);</p>
<p class="p2"><br></p>
<p class="p1">// If there is a next speaker, calculate its position based on the splay angle.</p>
<p class="p1">if (i &lt; arraySize - 1) {</p>
<p class="p1">// Use the splay angle above the next speaker.</p>
<p class="p1">let angle = splayAngles[i] || 0;</p>
<p class="p2"><br></p>
<p class="p1">// Calculate horizontal shift due to the splay angle.</p>
<p class="p1">// We assume the vertical spacing between speakers is rightHeightPx.</p>
<p class="p1">let horizShift = Math.tan(angle) * rightHeightPx;</p>
<p class="p2"><br></p>
<p class="p1">// Update currentX by adding the horizontal shift.</p>
<p class="p1">currentX += horizShift;</p>
<p class="p2"><br></p>
<p class="p1">// Move down vertically by the height of the current speaker on the right side.</p>
<p class="p1">currentY += rightHeightPx;</p>
<p class="p1">}</p>
<p class="p1">}</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">// Attach event listeners to update diagram on input changes.</p>
<p class="p1">const inputs = [</p>
<p class="p1">addLineArrayCheckbox,</p>
<p class="p1">trimHeightInput,</p>
<p class="p1">speakerPositionInput,</p>
<p class="p1">lineArraySizeInput,</p>
<p class="p1">...splayInputs</p>
<p class="p1">];</p>
<p class="p1">inputs.forEach(el =&gt; el.addEventListener('input', updateDiagram));</p>
<p class="p2"><br></p>
<p class="p1">// Initial rendering of the diagram.</p>
<p class="p1">updateDiagram();</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
